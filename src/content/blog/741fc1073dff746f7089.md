---
title: "S3をWebサーバーにしてコンテンツを公開する⑤（CloudFront署名付きCookie編）"
pubDate: "2021-03-11"
tags: ["AWS", "S3", "CloudFront"]
---

S3をWebサーバーにして静的コンテンツを公開する方法を紹介します。

1. [S3パブリック編](https://qiita.com/morikaz/items/8d196844aed38d0d8d0b)
2. [S3署名付きURL編](https://qiita.com/morikaz/items/0d9d69e21e0863204b8e)
3. [CloudFrontパブリック編](https://qiita.com/morikaz/items/04c053ead497e2a7c86c)
4. [CloudFront署名付きURL編](https://qiita.com/morikaz/items/f3159562caa133916bce)
5. [CloudFront署名付きCookie編](https://qiita.com/morikaz/items/741fc1073dff746f7089)　←コレ！

# 手順

今回の手順は、[CloudFront署名付きURL編](https://qiita.com/morikaz/items/f3159562caa133916bce)の続きで実施します。

## Cookieの設定

`aws cloudfront sign`コマンドで生成した署名付きURLのパラメーターをCookieに設定します。

| Cookie　Name | Cookie Value |
| --- | ---
| CloudFront-Expires | 署名付きURLのExpires |
| CloudFront-Key-Pair-Id | 署名付きURLのKey-Pair-Id | 
| CloudFront-Signature | 署名付きURLのSignature |

ただ署名付きURLのパラメーターの接頭辞として`CloudFront-`がついてるだけですね。
このCookieが設定されていれば、署名付きURLのクエリパラメーターがなくても、プライベートコンテンツにアクセスできるということです。

■署名付きURLの場合
https://d168j73yp42rht.cloudfront.net/private/index.html?Expires=XXXXXXXXXX&Key-Pair-Id=XXXXXXXXXX&Signature=XXXXXXXXXX

署名付きCookieの場合
https://d168j73yp42rht.cloudfront.net/private/index.html
※CookieでCloudFront-Expires、CloudFront-Key-Pair-Id、CloudFront-Signatureの指定が必要

以上です。
